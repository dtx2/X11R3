Return-Path: mcvax!cwi.nl!guido@uunet.uu.net
Received: by expo.lcs.mit.edu; Sat, 11 Jun 88 20:14:07 EDT
Received: from mcvax.UUCP by uunet.UU.NET (5.54/1.14) with UUCP 
	id AA23512; Sat, 11 Jun 88 20:12:38 EDT
Received: by mcvax.cwi.nl; Sat, 11 Jun 88 14:13:04 +0200 (MET)
Received: by piring.cwi.nl; Sat, 11 Jun 88 14:12:58 +0200 (MET)
Message-Id: <8806111212.AA24943@piring.cwi.nl>
To: xbugs@expo.lcs.mit.edu
Cc: mcvax!cwi.nl!guido@uunet.uu.net
Subject: xterm handling of some DEC special keys broken
From: Guido van Rossum <mcvax!cwi.nl!guido@uunet.uu.net>
Organization: CWI (Centre for Mathematics and Computer Science), Amsterdam
Phone: +31 20 5924138 (work), +31 20 225521 (home), +31 20 5924199 (fax)
Date: Sat, 11 Jun 88 14:12:57 +0100
Sender: mcvax!cwi.nl!guido@uunet.uu.net

### bug number:   592
### area:         xterm
### severity:     very low
### comments:     

VERSION:
	X11 release 2

CLIENT MACHINE:
	VaxStation 2000

CLIENT OPERATING SYSTEM:
	Ultrix 2.0

DISPLAY:
	QVSS

SYNOPSIS:
	xterm handling of some DEC special keys broken

DESCRIPTION:
	The symbols assigned to the Remove, Next Screen and Prev Screen
	keys on the DEC keyboard have been changed, but the special code
	in xterm to handle them has not been updated.  Here is a fix.

REPEAT-BY:
	On a VaxStation-2000, check what characters are generated by the
	mentioned keys, e.g. by typing
		stty -echo
		cat -v
	and pressing those keys.

FIX:

*** input.c.old	Thu Jun  9 11:21:55 1988
--- input.c	Tue May 31 13:58:42 1988
***************
*** 39,44 ****
--- 39,45 ----
  
  #include <X11/Xlib.h>
  #include <X11/keysym.h>
+ #include <X11/DECkeysym.h>
  #include <X11/Intrinsic.h>
  #include <X11/Xutil.h>
  #include <stdio.h>
***************
*** 89,95 ****
  		} else
  			unparseputc(kypd_num[keycode-XK_KP_Space], pty);
  		key = TRUE;
!         } else if (IsCursorKey(keycode)) {
         		if (keyboard->flags & CURSOR_APL) {
  			reply.a_type = SS3;
  			unparseseq(&reply, pty);
--- 90,97 ----
  		} else
  			unparseputc(kypd_num[keycode-XK_KP_Space], pty);
  		key = TRUE;
!         } else if (IsCursorKey(keycode) &&
!         	keycode != XK_Prior && keycode != XK_Next) {
         		if (keyboard->flags & CURSOR_APL) {
  			reply.a_type = SS3;
  			unparseseq(&reply, pty);
***************
*** 100,106 ****
  			unparseseq(&reply, pty);
  		}
  		key = TRUE;
! 	 } else if (IsFunctionKey(keycode) || IsMiscFunctionKey(keycode)) {
  		reply.a_type = CSI;
  		reply.a_nparam = 1;
  		reply.a_param[0] = funcvalue(keycode);
--- 102,110 ----
  			unparseseq(&reply, pty);
  		}
  		key = TRUE;
! 	 } else if (IsFunctionKey(keycode) || IsMiscFunctionKey(keycode) ||
! 	 	keycode == XK_Prior || keycode == XK_Next ||
! 	 	keycode == DXK_Remove) {
  		reply.a_type = CSI;
  		reply.a_nparam = 1;
  		reply.a_param[0] = funcvalue(keycode);
***************
*** 174,179 ****
--- 178,184 ----
  		case XK_Find :	return(1);
  		case XK_Insert:	return(2);
  		case XK_Delete:	return(3);
+ 		case DXK_Remove: return(3);
  		case XK_Select:	return(4);
  		case XK_Prior:	return(5);
  		case XK_Next:	return(6);

--
Guido van Rossum, Centre for Mathematics and Computer Science (CWI), Amsterdam
guido@cwi.nl or mcvax!guido or (from ARPAnet) guido%cwi.nl@uunet.uu.net

