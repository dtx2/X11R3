Return-Path: mcvax!cwi.nl!guido@uunet.uu.net
Received: by EXPO.LCS.MIT.EDU; Fri, 13 May 88 07:02:23 EDT
Received: from mcvax.UUCP by uunet.UU.NET (5.54/1.14) with UUCP 
	id AA03636; Fri, 13 May 88 07:01:17 EDT
Received: by mcvax.cwi.nl; Fri, 13 May 88 12:57:33 +0200 (MET)
Received: by piring.cwi.nl; Fri, 13 May 88 12:57:01 +0200 (MET)
Message-Id: <8805131057.AA08867@piring.cwi.nl>
To: xbugs@expo.lcs.mit.edu
Cc: mcvax!cwi.nl!guido@uunet.uu.net
Subject: X server writes on tail of rgb.dir
From: Guido van Rossum <mcvax!cwi.nl!guido@uunet.uu.net>
Organization: CWI (Centre for Mathematics and Computer Science), Amsterdam
Phone: +31 20 5924138 (work), +31 20 225521 (home), +31 20 5924199 (fax)
Date: Fri, 13 May 88 12:56:59 +0100
Sender: mcvax!cwi.nl!guido@uunet.uu.net

### bug number:   489
### area:         server
### severity:     low
### comments:     

VERSION:
	X11 release 2

CLIENT MACHINE:
	VaxStation 2000

CLIENT OPERATING SYSTEM:
	Ultrix 2.0

DISPLAY:
	QVSS

SYNOPSIS:
	X server writes on tail of rgb.dir

DESCRIPTION:
	I found on two occasions the text of an error message that would
	normally be written to stderr, appended to rgb.dir.  One message
	was 'longjmp botch', the other was 'sh: uncompress: not found'.
	(The latter message was probably generated by the
	compressed-font reading code, since for a while uncompress lived
	in a directory not in the default search path.)
	I haven't researched this properly, but I think the cause may be
	that in the 4.2bsd OsInit, the unchecked freopen call may be the
	cause.

REPEAT-BY:
	Don't know.

FIX:
	In osinit.c, in OsInit(), replace
		freopen (fname, "a+", stderr);
	by
		if (freopen (fname, "a+", stderr) == NULL)
			freopen("/dev/null", "w", stderr);
--
Guido van Rossum, Centre for Mathematics and Computer Science (CWI), Amsterdam
guido@cwi.nl or mcvax!guido or (from ARPAnet) guido%cwi.nl@uunet.uu.net

